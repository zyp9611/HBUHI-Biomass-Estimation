# Replication Data and Code for HBUHI Biomass Estimation

This repository contains the source code and datasets required to reproduce the findings of the manuscript submitted to *Ecological Informatics*:

**Title:** A Hapke-Based Bi-Temporal UAV Hyperspectral Index for Reducing Temporal Spectral Variations in Individual-Tree Biomass Estimation  
**Authors:** [Yinpeng Zhao, et al.]  
**Status:** Submitted / Under Review

## ðŸ“‚ Repository Structure

The repository is organized into two main directories: `code` and `data`.

### 1. `code/`
This directory contains the Jupyter Notebooks used for model inversion, index construction, and statistical validation.

*   **`Hapke_inversion.ipynb`**
    *   **Function:** Performs the inversion of the Hapke radiative transfer model.
    *   **Input:** Reads bi-temporal reflectance data (`ave_*.csv`) from `data/Original/`.
    *   **Output:** Generates single scattering albedo ($\omega$) spectra, saved to `data/processed/Hapke_result/`.

*   **`Biomass_Index_Construction.ipynb`**
    *   **Function:** Conducts the exhaustive search for 3-band combinations and identifies the optimal HBUHI.
    *   **Input:** Uses the retrieved $\omega$ and matches it with field biomass data (`shice_*.csv`).
    *   **Output:** Saves index calculation results to `data/processed/TBI/`.

*   **`cross-validation.ipynb`**
    *   **Function:** Validates model robustness and compares HBUHI with machine learning algorithms (PLSR, LASSO, RFR).
    *   **Output:** Saves validation metrics and plots to `data/processed/CV_results/`.

### 2. `data/`
This directory contains both the input data required to run the scripts and the output directories for results.

#### 2.1 `data/Original/` (Input Data)
This folder contains the **source datasets** required to run the analysis.

*   **Sample Raw Imagery:**
    *   `01_a.dat/hdr`, `01_b.dat/hdr`: Sample raw UAV hyperspectral imagery and header files for Plot 1 (Morning/Afternoon).
    *   *Note:* Due to the file size limit, only sample raw data is provided to demonstrate the data structure. The core analysis relies on the extracted CSV files below.

*   **Pre-processed Spectral Data (Input for Hapke Model):**
    *   `ave_01_o.csv`: Mean canopy reflectance spectra for individual trees in Plot 1 (Pre-processed from raw images).
    *   `ave_03_o.csv`: Mean canopy reflectance spectra for individual trees in Plot 3.
    *   *Format:* Rows represent individual trees; columns represent spectral bands.

*   **Field Survey Data (Ground Truth):**
    *   `shice_01.csv`: Field measured biomass data corresponding to Plot 1.
    *   `shice_03.csv`: Field measured biomass data corresponding to Plot 3.
    *   *Content:* Contains matched individual tree IDs and Aboveground Biomass (AGB, kg) derived from field inventory (DBH and Height).

#### 2.2 `data/processed/` (Output Directory)
This folder is structured to store the **results generated by the scripts**.
*(Note: Empty folders or existing results may be present)*

*   `Hapke_result/`: Stores the retrieved Single Scattering Albedo ($\omega$) spectra.
*   `TBI/`: Stores the calculated Three-Band Indices results.
*   `CV_results/`: Stores the cross-validation metrics and comparison tables.
*   `vegetation_indices/`: Stores results for traditional vegetation indices comparison.
*   `analyzes/`: Stores general statistical analysis outputs.

## ðŸš€ Usage Instructions

To reproduce the results, please execute the notebooks in the following order. Ensure you have installed the required dependencies listed in `requirements.txt`.

### Step 0: Environment Setup
```bash
pip install -r requirements.txt